SELECT '1' as NIVEL, G1.G1_COD, G1.G1_QUANT, G1.G1_COMP, A5.A5_NOMPROD, SB.B1_DESC, A5.A5_SITU, A5.A5_FORNECE, A5.A5_NOMEFOR, A5.A5_CODPRF, A5.A5_FABR
FROM SG1990 G1
INNER JOIN SA5990 A5 ON G1.G1_COD = A5.A5_PRODUTO
INNER JOIN SB1990 SB ON G1.G1_COMP = SB.B1_COD
WHERE G1.G1_COD = 'PA20020420' AND G1.D_E_L_E_T_ <> ''
UNION
SELECT '2' as NIVEL, G2.G1_COD, G2.G1_QUANT, G2.G1_COMP, A5.A5_NOMPROD, SB.B1_DESC, A5.A5_SITU, A5.A5_FORNECE, A5.A5_NOMEFOR, A5.A5_CODPRF, A5.A5_FABR
FROM SG1990 G2
INNER JOIN SA5990 A5 ON G2.G1_COD = A5.A5_PRODUTO
INNER JOIN SB1990 SB ON G2.G1_COMP = SB.B1_COD
WHERE G2.G1_COD IN
(SELECT DISTINCT G1_COMP FROM SG1990 WHERE G1_COD = 'PA20020420' AND D_E_L_E_T_ <> '' AND SUBSTRING(G1_COMP, 1, 2) <> 'MO') AND G2.D_E_L_E_T_ <> ''
UNION
SELECT '3' as NIVEL, G3.G1_COD, G3.G1_QUANT, G3.G1_COMP, A5.A5_NOMPROD, SB.B1_DESC, A5.A5_SITU, A5.A5_FORNECE, A5.A5_NOMEFOR, A5.A5_CODPRF, A5.A5_FABR
FROM SG1990 G3
INNER JOIN SA5990 A5 ON G3.G1_COD = A5.A5_PRODUTO
INNER JOIN SB1990 SB ON G3.G1_COMP = SB.B1_COD
WHERE G3.G1_COD IN
(SELECT DISTINCT G1_COMP FROM SG1990 WHERE G1_COD IN
(SELECT DISTINCT G1_COMP FROM SG1990 WHERE G1_COD = 'PA20020420' AND D_E_L_E_T_ <> '' AND SUBSTRING(G1_COMP, 1, 2) <> 'MO') AND G3.D_E_L_E_T_ <> '')
UNION
SELECT '4' as NIVEL, G4.G1_COD, G4.G1_QUANT, G4.G1_COMP, A5.A5_NOMPROD, SB.B1_DESC, A5.A5_SITU, A5.A5_FORNECE, A5.A5_NOMEFOR, A5.A5_CODPRF, A5.A5_FABR
FROM SG1990 G4
INNER JOIN SA5990 A5 ON G4.G1_COD = A5.A5_PRODUTO
INNER JOIN SB1990 SB ON G4.G1_COMP = SB.B1_COD
WHERE G4.G1_COD IN
(SELECT DISTINCT G1_COMP FROM SG1990 WHERE G1_COD IN
(SELECT DISTINCT G1_COMP FROM SG1990 WHERE G1_COD IN
(SELECT DISTINCT G1_COMP FROM SG1990 WHERE G1_COD IN
(SELECT DISTINCT G1_COMP FROM SG1990 WHERE G4.D_E_L_E_T_ <> '' AND G4.G1_COD = 'PA20020420' AND SUBSTRING(G1_COMP, 1, 2) <> 'MO')))) AND G4.D_E_L_E_T_ <> '*'
ORDER BY NIVEL, G1.G1_COD, G1.G1_COMP